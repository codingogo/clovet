<%= link_to "Home", root_path %>

  <div id="viewport">
    <ul class="stack" id="img-source">
      <li class="spades">
         <img src="<%= @item.image_url400 %>" alt="">
          
          <div class="yes"></div>
          <div class="no"></div>
      </li>
    </ul>
  </div>  

<%= @item.name %>

<%=    link_to "Like", @like, id: "like-btn" %>

<%=    link_to "Dislike", @dislike, id: "dislike-btn" %>








<div id="like" data-item-id="<%= @item.id%>" data-like="true" data-clicked-through="false">
	<%=    link_to "Like", @like %>
</div>

<div id="dislike" data-item-id="<%= @item.id%>" data-like="false" data-clicked-through="false">
	<%=    link_to "Dislike", @dislike %>
</div>

<div id="buy" data-item-id="<%= @item.id%>" data-like="true" data-clicked-through="true"> 
	<%= link_to "Buy", @item.merchant_url, :target => '_blank'  %>
</div>


<script>

	var add_to_history = function() {
	$.ajax({
	    type: 'POST',
	    url: '/add_to_history',
	    data: { itemId: $(this).attr('data-item-id'),  
	    				likeOrNot: $(this).attr('data-like'), 
	    				clickedThrough: $(this).attr('data-clicked-through') }
	  });
	// console.log(this);
	 console.log(<%= @item.id %>)
	 console.log(<%= @user.id  %>)

	}


	$('#like').on('click', add_to_history);
	$('#dislike').on('click', add_to_history);
	$('#buy').on('click', add_to_history);

</script>



<!-- ================= Script below to be relocated  ================================ -->

<script>

$(document).ready(function(){
  var $imgSource = $('#img-source');
  var $likeBtn = $('#like-btn');
  var $dislikeBtn = $('#dislike-btn');
  
  // when imgSource starts moving check 
  // $imgSource.on('click', 'li', function(){
  //   window.location = '/items/' + (Math.floor((Math.random() * 100) + 1))

  // ****** if the imgSource is swiped left submit form A
  
  // ****** if the imgSource is swiped right submit form B  

//   $( "#target" ).submit(function( event ) {
//   alert( "Handler for .submit() called." );
//   event.preventDefault();
// });

  // });

})  

</script>
  


<script>
  
var swingIt = function(){

  // querySelector means $('.stack li')
    var stack = gajus.Swing.Stack(),
        cardElement = document.querySelector('.stack li'),
        throwOutConfidenceBind = document.querySelector('#throw-out-confidence-bind'),
        directionBind = document.querySelector('#direction-bind'),
        throwOutConfidenceElements = {};

    window.card = stack.createCard(cardElement);

    stack.on('dragstart', function (e) {
        throwOutConfidenceElements.yes = e.target.querySelector('.yes').style;
        throwOutConfidenceElements.no = e.target.querySelector('.no').style;
    });

    stack.on('dragmove', function (e) {
        throwOutConfidenceElements[e.throwDirection == gajus.Swing.Card.DIRECTION_RIGHT ? 'yes' : 'no'].opacity = e.throwOutConfidence;

        // throwOutConfidenceBind.innerHTML = e.throwOutConfidence.toFixed(3);
        // directionBind.innerHTML = e.throwDirection == gajus.Swing.Card.DIRECTION_RIGHT ? 'right' : 'left';
    });

    stack.on('dragend', function (e) {
        if (e.throwOutConfidence != 1) {
            throwOutConfidenceElements.yes.opacity = 0;
            throwOutConfidenceElements.no.opacity = 0;
        }
    });


    // stack.on('throwoutleft', function() {
    //   console.log('sdfsdfsdlkfjslkdf');

    //   $( "#target" ).submit(function( event ) {
    //     alert( "Handler for .submit() called." );
    //     event.preventDefault();
    //   });  // update this to submit form!!!!!!!

    // })

    
  };


    swingIt();


</script>
